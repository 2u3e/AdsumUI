<div
  class="flex items-center justify-center grow bg-center bg-no-repeat page-bg"
>
  <div class="login-card max-w-[440px] w-full">
    <form
      [formGroup]="loginForm"
      (ngSubmit)="onSubmit()"
      (keypress)="onKeyPress($event)"
      class="kt-card-content flex flex-col gap-6 p-12"
      id="sign_in_form"
    >
      <div class="text-center mb-2">
        <h3
          class="text-2xl font-semibold text-gray-900 dark:text-white leading-none mb-3"
        >
          Hoş Geldiniz
        </h3>
        <div class="text-sm text-gray-500 dark:text-gray-400">
          Devam etmek için giriş yapın
        </div>
      </div>

      <!-- Hata mesajı -->
      @if (errorMessage()) {
        <div class="error-message">
          <i class="ki-filled ki-information"></i>
          <span>{{ errorMessage() }}</span>
        </div>
      }

      <!-- Kullanıcı Adı / Email alanı -->
      <div class="flex flex-col gap-2">
        <label class="input-label"> Kullanıcı Adı veya Email </label>
        <div class="input-wrapper">
          <i class="ki-filled ki-user input-icon"></i>
          <input
            class="modern-input"
            [class.error]="isFieldInvalid('username')"
            placeholder="kullaniciadi@example.com"
            type="text"
            formControlName="username"
            autocomplete="username"
          />
        </div>

        @if (isFieldInvalid("username")) {
          <span class="field-error">
            <i class="ki-filled ki-information"></i>
            {{ getFieldError("username") }}
          </span>
        }
      </div>

      <!-- Şifre alanı -->
      <div class="flex flex-col gap-2">
        <div class="flex items-center justify-between">
          <label class="input-label">Şifre</label>
          <a class="forgot-password-link" href="/forgot-password">
            Şifremi Unuttum
          </a>
        </div>
        <div class="input-wrapper">
          <i class="ki-filled ki-lock-2 input-icon"></i>
          <input
            class="modern-input"
            [class.error]="isFieldInvalid('password')"
            formControlName="password"
            placeholder="••••••••"
            [type]="showPassword() ? 'text' : 'password'"
            autocomplete="current-password"
          />
          <button
            class="password-toggle"
            type="button"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="
              showPassword() ? 'Şifreyi gizle' : 'Şifreyi göster'
            "
          >
            @if (showPassword()) {
              <i class="ki-filled ki-eye-slash"></i>
            } @else {
              <i class="ki-filled ki-eye"></i>
            }
          </button>
        </div>

        @if (isFieldInvalid("password")) {
          <span class="field-error">
            <i class="ki-filled ki-information"></i>
            {{ getFieldError("password") }}
          </span>
        }
      </div>

      <!-- Giriş butonu -->
      <button class="login-button" type="submit" [disabled]="isLoading()">
        @if (isLoading()) {
          <span class="flex items-center gap-2">
            <div class="spinner"></div>
            Giriş Yapılıyor...
          </span>
        } @else {
          Giriş Yap
        }
      </button>
    </form>
  </div>
</div>
